<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.zebone.dip.md.dao.MasterDataFieldMapper" >
  <resultMap id="MasterDataFieldMap" type="com.zebone.dip.md.vo.MasterDataField" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jul 01 16:41:00 CST 2013.
    -->
    <id column="ID_" property="id" jdbcType="VARCHAR" />
    <result column="FIELD_NAME" property="fieldName" jdbcType="VARCHAR" />
    <result column="DISPLAY_NAME" property="displayName" jdbcType="VARCHAR" />
    <result column="FIELD_TYPE" property="fieldType" jdbcType="VARCHAR" />
    <result column="COMMENT" property="comment" jdbcType="VARCHAR" />
    <result column="FIELD_LENGTH" property="fieldLength" jdbcType="VARCHAR" />
    <result column="TYPE_CODE" property="typeCode" jdbcType="VARCHAR" />
    <result column="NULLABLE" property="nullable" jdbcType="VARCHAR" />
    <result column="SORT_NO" property="sortNo" jdbcType="DECIMAL" />
    <result column="MASTER_DATA_ID" property="masterDataId" jdbcType="VARCHAR" />
    <result column="DISPLAYABLE" property="displayable" jdbcType="VARCHAR" />
    <result column="CHECK_RULE" property="checkRule" jdbcType="VARCHAR" />
  </resultMap>
  <sql id="MasterDataFieldList" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jul 01 16:41:00 CST 2013.
    -->
    ID_, FIELD_NAME, DISPLAY_NAME, FIELD_TYPE, FIELD_LENGTH, TYPE_CODE, NULLABLE,
    SORT_NO, MASTER_DATA_ID, DISPLAYABLE, CHECK_RULE
  </sql>

  <select id="selectByPrimaryKey" resultMap="MasterDataFieldMap" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jul 01 16:41:00 CST 2013.
    -->
    select 
    <include refid="MasterDataFieldList" />
    from P_MASTER_DATA_FIELD
    where ID_ = #{id,jdbcType=VARCHAR}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jul 01 16:41:00 CST 2013.
    -->
    delete from P_MASTER_DATA_FIELD
    where ID_ = #{id,jdbcType=VARCHAR}
  </delete>
  <insert id="insert" parameterType="com.zebone.dip.md.vo.MasterDataField" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jul 01 16:41:00 CST 2013.
    -->
    insert into P_MASTER_DATA_FIELD (ID_, FIELD_NAME, DISPLAY_NAME, 
      FIELD_TYPE, COMMENT, FIELD_LENGTH, 
      TYPE_CODE, NULLABLE, SORT_NO, 
      MASTER_DATA_ID, DISPLAYABLE, CHECK_RULE
      )
    values (#{id,jdbcType=VARCHAR}, #{fieldName,jdbcType=VARCHAR}, #{displayName,jdbcType=VARCHAR}, 
      #{fieldType,jdbcType=VARCHAR}, #{comment,jdbcType=VARCHAR}, #{fieldLength,jdbcType=VARCHAR}, 
      #{typeCode,jdbcType=VARCHAR}, #{nullable,jdbcType=VARCHAR}, #{sortNo,jdbcType=DECIMAL}, 
      #{masterDataId,jdbcType=VARCHAR}, #{displayable,jdbcType=VARCHAR}, #{checkRule,jdbcType=VARCHAR}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.zebone.dip.md.vo.MasterDataField" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jul 01 16:41:00 CST 2013.
    -->
    insert into P_MASTER_DATA_FIELD
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        ID_,
      </if>
      <if test="fieldName != null" >
        FIELD_NAME,
      </if>
      <if test="displayName != null" >
        DISPLAY_NAME,
      </if>
      <if test="fieldType != null" >
        FIELD_TYPE,
      </if>
      <if test="comment != null" >
        COMMENT,
      </if>
      <if test="fieldLength != null" >
        FIELD_LENGTH,
      </if>
      <if test="typeCode != null" >
        TYPE_CODE,
      </if>
      <if test="nullable != null" >
        NULLABLE,
      </if>
      <if test="sortNo != null" >
        SORT_NO,
      </if>
      <if test="masterDataId != null" >
        MASTER_DATA_ID,
      </if>
      <if test="displayable != null" >
        DISPLAYABLE,
      </if>
      <if test="checkRule != null" >
        CHECK_RULE,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        #{id,jdbcType=VARCHAR},
      </if>
      <if test="fieldName != null" >
        #{fieldName,jdbcType=VARCHAR},
      </if>
      <if test="displayName != null" >
        #{displayName,jdbcType=VARCHAR},
      </if>
      <if test="fieldType != null" >
        #{fieldType,jdbcType=VARCHAR},
      </if>
      <if test="comment != null" >
        #{comment,jdbcType=VARCHAR},
      </if>
      <if test="fieldLength != null" >
        #{fieldLength,jdbcType=VARCHAR},
      </if>
      <if test="typeCode != null" >
        #{typeCode,jdbcType=VARCHAR},
      </if>
      <if test="nullable != null" >
        #{nullable,jdbcType=VARCHAR},
      </if>
      <if test="sortNo != null" >
        #{sortNo,jdbcType=DECIMAL},
      </if>
      <if test="masterDataId != null" >
        #{masterDataId,jdbcType=VARCHAR},
      </if>
      <if test="displayable != null" >
        #{displayable,jdbcType=VARCHAR},
      </if>
      <if test="checkRule != null" >
        #{checkRule,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.zebone.dip.md.vo.MasterDataField" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jul 01 16:41:00 CST 2013.
    -->
    update P_MASTER_DATA_FIELD
    <set >
      <if test="fieldName != null" >
        FIELD_NAME = #{fieldName,jdbcType=VARCHAR},
      </if>
      <if test="displayName != null" >
        DISPLAY_NAME = #{displayName,jdbcType=VARCHAR},
      </if>
      <if test="fieldType != null" >
        FIELD_TYPE = #{fieldType,jdbcType=VARCHAR},
      </if>
      <if test="comment != null" >
        COMMENT = #{comment,jdbcType=VARCHAR},
      </if>
      <if test="fieldLength != null" >
        FIELD_LENGTH = #{fieldLength,jdbcType=VARCHAR},
      </if>
      <if test="typeCode != null" >
        TYPE_CODE = #{typeCode,jdbcType=VARCHAR},
      </if>
      <if test="nullable != null" >
        NULLABLE = #{nullable,jdbcType=VARCHAR},
      </if>
      <if test="sortNo != null" >
        SORT_NO = #{sortNo,jdbcType=DECIMAL},
      </if>
      <if test="masterDataId != null" >
        MASTER_DATA_ID = #{masterDataId,jdbcType=VARCHAR},
      </if>
      <if test="displayable != null" >
        DISPLAYABLE = #{displayable,jdbcType=VARCHAR},
      </if>
      <if test="checkRule != null" >
        CHECK_RULE = #{checkRule,jdbcType=VARCHAR},
      </if>
    </set>
    where ID_ = #{id,jdbcType=VARCHAR}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.zebone.dip.md.vo.MasterDataField" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jul 01 16:41:00 CST 2013.
    -->
    update P_MASTER_DATA_FIELD
    set FIELD_NAME = #{fieldName,jdbcType=VARCHAR},
      DISPLAY_NAME = #{displayName,jdbcType=VARCHAR},
      FIELD_TYPE = #{fieldType,jdbcType=VARCHAR},
      COMMENT = #{comment,jdbcType=VARCHAR},
      FIELD_LENGTH = #{fieldLength,jdbcType=VARCHAR},
      TYPE_CODE = #{typeCode,jdbcType=VARCHAR},
      NULLABLE = #{nullable,jdbcType=VARCHAR},
      SORT_NO = #{sortNo,jdbcType=DECIMAL},
      MASTER_DATA_ID = #{masterDataId,jdbcType=VARCHAR},
      DISPLAYABLE = #{displayable,jdbcType=VARCHAR},
      CHECK_RULE = #{checkRule,jdbcType=VARCHAR}
    where ID_ = #{id,jdbcType=VARCHAR}
  </update>

    <select id="getFieldByMasterDataId" parameterType="java.lang.String"
            resultMap="MasterDataFieldMap">
        select *
        from P_MASTER_DATA_FIELD
        <where>
            MASTER_DATA_ID = #{masterDataId,jdbcType=VARCHAR}
        </where>
        order by SORT_NO NULLS FIRST ,FIELD_NAME
    </select>

    <!-- 查询实体列表
    公共方法 分页 -->
    <select id="getDetailObject" parameterType="MasterDataQuery"
            statementType="PREPARED" resultType="map">
        select * from ${dbName} where IS_DELETED=0
        <if test="mdNameValue != null and mdNameValue != '' ">
            AND (MD_NAME LIKE
            '%'||#{mdNameValue,jdbcType=VARCHAR}||'%' escape '/'
            or MD_CODE LIKE
            '%'||#{mdNameValue,jdbcType=VARCHAR}||'%' escape '/'
            )
        </if>
        order by MD_CODE
    </select>

    <!-- 查询实体总数公共方法 -->
    <select id="getDetailObjectTotal" parameterType="MasterDataQuery"
            resultType="int">
        select count(1) from ${dbName} where IS_DELETED=0
        <if test="mdNameValue != null and mdNameValue != '' ">
            AND (MD_NAME LIKE
            '%'||#{mdNameValue,jdbcType=VARCHAR}||'%' escape '/'
            or MD_CODE LIKE
            '%'||#{mdNameValue,jdbcType=VARCHAR}||'%' escape '/'
            )
        </if>
    </select>

    <!-- 动态SQL之根据ID查询  -->
    <select id="getMtDetailsById" parameterType="MasterDataQuery"
            statementType="PREPARED" resultType="map">
		select * from ${dbName} where ${primaryKeyField} =
		#{primaryKeyValue} and IS_DELETED=0
	</select>

    <!-- 动态SQL之插入数据  -->
    <insert id="saveMDContentInfo" statementType="PREPARED"
            parameterType="MasterDataQuery">
        insert into ${dbName} (ID_, ${dbFields}, timestamp) values
        <foreach item="item" index="index" collection="valueList"
                 open="(" separator=",">
            #{item}
        </foreach>
        ,CURRENT_TIMESTAMP)
    </insert>

    <!-- 动态SQL之根据ID物理删除数据 -->
    <delete id="physicalDeleteMDContent" parameterType="MasterDataQuery">
		delete from ${dbName} where ${primaryKeyField} =
		#{primaryKeyValue} and IS_DELETED=0
	</delete>
	<!-- 动态SQL之根据ID逻辑删除数据 -->
    <delete id="deleteMDContent" parameterType="MasterDataQuery">
		update ${dbName} set IS_DELETED=1, timestamp=CURRENT_TIMESTAMP where ${primaryKeyField} = #{primaryKeyValue}
	</delete>

    <!-- 动态SQL之批量物理删除数据 公共方法 -->
    <!-- <delete id="removeMDContentInfo" parameterType="MasterDataQuery">
        delete from ${dbName} where ${primaryKeyField} in
        <foreach item="item" index="index" collection="idList" open="("
                 separator="," close=")">
            #{item}
        </foreach>
    </delete> -->
    <!-- 动态SQL之批量逻辑删除数据 公共方法 -->
    <delete id="removeMDContentInfo" parameterType="MasterDataQuery">
      update ${dbName} set IS_DELETED=1 , timestamp=CURRENT_TIMESTAMP where ${primaryKeyField} in
        <foreach item="item" index="index" collection="idList" open="("
                 separator="," close=")">
            #{item}
        </foreach>
    </delete>

    <select id="getMDNameLic" parameterType="MasterDataQuery"
            statementType="PREPARED" resultType="com.zebone.dip.md.vo.NameCode">
        select MD_NAME as name,MD_CODE as code from ${dbName} where MD_NAME IS NOT NULL and IS_DELETED=0
    </select>

    <select id="countMDInfo" parameterType="MasterDataQuery" resultType="int">
        select count(1) from ${dbName} where MD_CODE = #{fieldValue} and ID_ <![CDATA[<>]]> #{primaryKeyValue} and IS_DELETED=0
    </select>

</mapper>